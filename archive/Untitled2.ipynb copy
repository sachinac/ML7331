{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2020-08-03T18:21:20.537308Z",
     "start_time": "2020-08-03T18:21:11.399267Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "TuriCreate currently only supports using one GPU. Setting 'num_gpus' to 1.\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<pre>Finished parsing file /Users/sachin/Documents/sachin/Education/SMU/Term4/7331/DataMining/ML7331/movielens/ratings.csv</pre>"
      ],
      "text/plain": [
       "Finished parsing file /Users/sachin/Documents/sachin/Education/SMU/Term4/7331/DataMining/ML7331/movielens/ratings.csv"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>Parsing completed. Parsed 100 lines in 0.477265 secs.</pre>"
      ],
      "text/plain": [
       "Parsing completed. Parsed 100 lines in 0.477265 secs."
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------------------------------\n",
      "Inferred types from first 100 line(s) of file as \n",
      "column_type_hints=[int,int,float,int]\n",
      "If parsing fails due to incorrect types, you can correct\n",
      "the inferred type list above and pass it to read_csv in\n",
      "the column_type_hints argument\n",
      "------------------------------------------------------\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<pre>Read 2006281 lines. Lines per second: 2.3563e+06</pre>"
      ],
      "text/plain": [
       "Read 2006281 lines. Lines per second: 2.3563e+06"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>Read 25014145 lines. Lines per second: 4.10805e+06</pre>"
      ],
      "text/plain": [
       "Read 25014145 lines. Lines per second: 4.10805e+06"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>Finished parsing file /Users/sachin/Documents/sachin/Education/SMU/Term4/7331/DataMining/ML7331/movielens/ratings.csv</pre>"
      ],
      "text/plain": [
       "Finished parsing file /Users/sachin/Documents/sachin/Education/SMU/Term4/7331/DataMining/ML7331/movielens/ratings.csv"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>Parsing completed. Parsed 26024289 lines in 6.26922 secs.</pre>"
      ],
      "text/plain": [
       "Parsing completed. Parsed 26024289 lines in 6.26922 secs."
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "import turicreate as tc\n",
    "tc.config.set_num_gpus(2)\n",
    "actions = tc.SFrame.read_csv('movielens/ratings.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "ExecuteTime": {
     "start_time": "2020-08-04T02:14:44.440Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<pre>Preparing data set.</pre>"
      ],
      "text/plain": [
       "Preparing data set."
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>    Data has 26004589 observations with 270892 users and 45108 items.</pre>"
      ],
      "text/plain": [
       "    Data has 26004589 observations with 270892 users and 45108 items."
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>    Data prepared in: 14.7898s</pre>"
      ],
      "text/plain": [
       "    Data prepared in: 14.7898s"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>Training ranking_factorization_recommender for recommendations.</pre>"
      ],
      "text/plain": [
       "Training ranking_factorization_recommender for recommendations."
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>+--------------------------------+--------------------------------------------------+----------+</pre>"
      ],
      "text/plain": [
       "+--------------------------------+--------------------------------------------------+----------+"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>| Parameter                      | Description                                      | Value    |</pre>"
      ],
      "text/plain": [
       "| Parameter                      | Description                                      | Value    |"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>+--------------------------------+--------------------------------------------------+----------+</pre>"
      ],
      "text/plain": [
       "+--------------------------------+--------------------------------------------------+----------+"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>| num_factors                    | Factor Dimension                                 | 32       |</pre>"
      ],
      "text/plain": [
       "| num_factors                    | Factor Dimension                                 | 32       |"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>| regularization                 | L2 Regularization on Factors                     | 1e-09    |</pre>"
      ],
      "text/plain": [
       "| regularization                 | L2 Regularization on Factors                     | 1e-09    |"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>| solver                         | Solver used for training                         | adagrad  |</pre>"
      ],
      "text/plain": [
       "| solver                         | Solver used for training                         | adagrad  |"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>| linear_regularization          | L2 Regularization on Linear Coefficients         | 1e-09    |</pre>"
      ],
      "text/plain": [
       "| linear_regularization          | L2 Regularization on Linear Coefficients         | 1e-09    |"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>| ranking_regularization         | Rank-based Regularization Weight                 | 0.25     |</pre>"
      ],
      "text/plain": [
       "| ranking_regularization         | Rank-based Regularization Weight                 | 0.25     |"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>| max_iterations                 | Maximum Number of Iterations                     | 25       |</pre>"
      ],
      "text/plain": [
       "| max_iterations                 | Maximum Number of Iterations                     | 25       |"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>+--------------------------------+--------------------------------------------------+----------+</pre>"
      ],
      "text/plain": [
       "+--------------------------------+--------------------------------------------------+----------+"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>  Optimizing model using SGD; tuning step size.</pre>"
      ],
      "text/plain": [
       "  Optimizing model using SGD; tuning step size."
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>  Using 3250573 / 26004589 points for tuning the step size.</pre>"
      ],
      "text/plain": [
       "  Using 3250573 / 26004589 points for tuning the step size."
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>+---------+-------------------+------------------------------------------+</pre>"
      ],
      "text/plain": [
       "+---------+-------------------+------------------------------------------+"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>| Attempt | Initial Step Size | Estimated Objective Value                |</pre>"
      ],
      "text/plain": [
       "| Attempt | Initial Step Size | Estimated Objective Value                |"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>+---------+-------------------+------------------------------------------+</pre>"
      ],
      "text/plain": [
       "+---------+-------------------+------------------------------------------+"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>| 0       | 16.6667           | Not Viable                               |</pre>"
      ],
      "text/plain": [
       "| 0       | 16.6667           | Not Viable                               |"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>| 1       | 4.16667           | Not Viable                               |</pre>"
      ],
      "text/plain": [
       "| 1       | 4.16667           | Not Viable                               |"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>| 2       | 1.04167           | Not Viable                               |</pre>"
      ],
      "text/plain": [
       "| 2       | 1.04167           | Not Viable                               |"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>| 3       | 0.260417          | Not Viable                               |</pre>"
      ],
      "text/plain": [
       "| 3       | 0.260417          | Not Viable                               |"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>| 4       | 0.0651042         | 1.38651                                  |</pre>"
      ],
      "text/plain": [
       "| 4       | 0.0651042         | 1.38651                                  |"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>| 5       | 0.0325521         | 1.20467                                  |</pre>"
      ],
      "text/plain": [
       "| 5       | 0.0325521         | 1.20467                                  |"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>| 6       | 0.016276          | 1.4265                                   |</pre>"
      ],
      "text/plain": [
       "| 6       | 0.016276          | 1.4265                                   |"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>| 7       | 0.00813802        | 1.47724                                  |</pre>"
      ],
      "text/plain": [
       "| 7       | 0.00813802        | 1.47724                                  |"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>| 8       | 0.00406901        | 1.88571                                  |</pre>"
      ],
      "text/plain": [
       "| 8       | 0.00406901        | 1.88571                                  |"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>+---------+-------------------+------------------------------------------+</pre>"
      ],
      "text/plain": [
       "+---------+-------------------+------------------------------------------+"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>| Final   | 0.0325521         | 1.20467                                  |</pre>"
      ],
      "text/plain": [
       "| Final   | 0.0325521         | 1.20467                                  |"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>+---------+-------------------+------------------------------------------+</pre>"
      ],
      "text/plain": [
       "+---------+-------------------+------------------------------------------+"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>Starting Optimization.</pre>"
      ],
      "text/plain": [
       "Starting Optimization."
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>+---------+--------------+-------------------+-----------------------+-------------+</pre>"
      ],
      "text/plain": [
       "+---------+--------------+-------------------+-----------------------+-------------+"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>| Iter.   | Elapsed Time | Approx. Objective | Approx. Training RMSE | Step Size   |</pre>"
      ],
      "text/plain": [
       "| Iter.   | Elapsed Time | Approx. Objective | Approx. Training RMSE | Step Size   |"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>+---------+--------------+-------------------+-----------------------+-------------+</pre>"
      ],
      "text/plain": [
       "+---------+--------------+-------------------+-----------------------+-------------+"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>| Initial | 2.141ms      | 2.2258            | 1.06547               |             |</pre>"
      ],
      "text/plain": [
       "| Initial | 2.141ms      | 2.2258            | 1.06547               |             |"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>+---------+--------------+-------------------+-----------------------+-------------+</pre>"
      ],
      "text/plain": [
       "+---------+--------------+-------------------+-----------------------+-------------+"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>| 1       | 28.10s       | 1.27484           | 0.94914               | 0.0325521   |</pre>"
      ],
      "text/plain": [
       "| 1       | 28.10s       | 1.27484           | 0.94914               | 0.0325521   |"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>| 2       | 1m 5s        | 1.20137           | 0.930351              | 0.0325521   |</pre>"
      ],
      "text/plain": [
       "| 2       | 1m 5s        | 1.20137           | 0.930351              | 0.0325521   |"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>| 3       | 1m 39s       | 1.1414            | 0.915386              | 0.0325521   |</pre>"
      ],
      "text/plain": [
       "| 3       | 1m 39s       | 1.1414            | 0.915386              | 0.0325521   |"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>| 4       | 2m 9s        | 1.15033           | 0.919998              | 0.0325521   |</pre>"
      ],
      "text/plain": [
       "| 4       | 2m 9s        | 1.15033           | 0.919998              | 0.0325521   |"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>| 5       | 2m 39s       | 1.1106            | 0.904788              | 0.0325521   |</pre>"
      ],
      "text/plain": [
       "| 5       | 2m 39s       | 1.1106            | 0.904788              | 0.0325521   |"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>| 7       | 3m 43s       | 1.07434           | 0.894252              | 0.0325521   |</pre>"
      ],
      "text/plain": [
       "| 7       | 3m 43s       | 1.07434           | 0.894252              | 0.0325521   |"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>| 8       | 4m 14s       | 1.05791           | 0.890311              | 0.0325521   |</pre>"
      ],
      "text/plain": [
       "| 8       | 4m 14s       | 1.05791           | 0.890311              | 0.0325521   |"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>| 9       | 4m 47s       | 1.04589           | 0.886908              | 0.0325521   |</pre>"
      ],
      "text/plain": [
       "| 9       | 4m 47s       | 1.04589           | 0.886908              | 0.0325521   |"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>| 10      | 5m 23s       | 1.03427           | 0.88363               | 0.0325521   |</pre>"
      ],
      "text/plain": [
       "| 10      | 5m 23s       | 1.03427           | 0.88363               | 0.0325521   |"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>| 11      | 6m 3s        | 1.02282           | 0.880534              | 0.0325521   |</pre>"
      ],
      "text/plain": [
       "| 11      | 6m 3s        | 1.02282           | 0.880534              | 0.0325521   |"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>| 12      | 6m 44s       | 1.01484           | 0.87808               | 0.0325521   |</pre>"
      ],
      "text/plain": [
       "| 12      | 6m 44s       | 1.01484           | 0.87808               | 0.0325521   |"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "training_data, validation_data = tc.recommender.util.random_split_by_user(actions, 'userId', 'movieId')\n",
    "model = tc.recommender.create(training_data, user_id='userId', item_id='movieId',target='rating')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2020-08-04T02:12:58.149778Z",
     "start_time": "2020-08-04T02:12:06.146666Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 1000/270892 queries. users per second: 6719.44</pre>"
      ],
      "text/plain": [
       "recommendations finished on 1000/270892 queries. users per second: 6719.44"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 2000/270892 queries. users per second: 6856.55</pre>"
      ],
      "text/plain": [
       "recommendations finished on 2000/270892 queries. users per second: 6856.55"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 3000/270892 queries. users per second: 6757</pre>"
      ],
      "text/plain": [
       "recommendations finished on 3000/270892 queries. users per second: 6757"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 4000/270892 queries. users per second: 6848.72</pre>"
      ],
      "text/plain": [
       "recommendations finished on 4000/270892 queries. users per second: 6848.72"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 5000/270892 queries. users per second: 6967.34</pre>"
      ],
      "text/plain": [
       "recommendations finished on 5000/270892 queries. users per second: 6967.34"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 6000/270892 queries. users per second: 7035.19</pre>"
      ],
      "text/plain": [
       "recommendations finished on 6000/270892 queries. users per second: 7035.19"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 7000/270892 queries. users per second: 7044.15</pre>"
      ],
      "text/plain": [
       "recommendations finished on 7000/270892 queries. users per second: 7044.15"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 8000/270892 queries. users per second: 7004.27</pre>"
      ],
      "text/plain": [
       "recommendations finished on 8000/270892 queries. users per second: 7004.27"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 9000/270892 queries. users per second: 7041.91</pre>"
      ],
      "text/plain": [
       "recommendations finished on 9000/270892 queries. users per second: 7041.91"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 10000/270892 queries. users per second: 6968.27</pre>"
      ],
      "text/plain": [
       "recommendations finished on 10000/270892 queries. users per second: 6968.27"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 11000/270892 queries. users per second: 6963.61</pre>"
      ],
      "text/plain": [
       "recommendations finished on 11000/270892 queries. users per second: 6963.61"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 12000/270892 queries. users per second: 6952.29</pre>"
      ],
      "text/plain": [
       "recommendations finished on 12000/270892 queries. users per second: 6952.29"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 13000/270892 queries. users per second: 6971.52</pre>"
      ],
      "text/plain": [
       "recommendations finished on 13000/270892 queries. users per second: 6971.52"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 14000/270892 queries. users per second: 6960.47</pre>"
      ],
      "text/plain": [
       "recommendations finished on 14000/270892 queries. users per second: 6960.47"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 15000/270892 queries. users per second: 6899.09</pre>"
      ],
      "text/plain": [
       "recommendations finished on 15000/270892 queries. users per second: 6899.09"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 16000/270892 queries. users per second: 6907.47</pre>"
      ],
      "text/plain": [
       "recommendations finished on 16000/270892 queries. users per second: 6907.47"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 17000/270892 queries. users per second: 6865.55</pre>"
      ],
      "text/plain": [
       "recommendations finished on 17000/270892 queries. users per second: 6865.55"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 18000/270892 queries. users per second: 6831.69</pre>"
      ],
      "text/plain": [
       "recommendations finished on 18000/270892 queries. users per second: 6831.69"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 19000/270892 queries. users per second: 6832.85</pre>"
      ],
      "text/plain": [
       "recommendations finished on 19000/270892 queries. users per second: 6832.85"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 20000/270892 queries. users per second: 6860.09</pre>"
      ],
      "text/plain": [
       "recommendations finished on 20000/270892 queries. users per second: 6860.09"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 21000/270892 queries. users per second: 6852.19</pre>"
      ],
      "text/plain": [
       "recommendations finished on 21000/270892 queries. users per second: 6852.19"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 22000/270892 queries. users per second: 6848.59</pre>"
      ],
      "text/plain": [
       "recommendations finished on 22000/270892 queries. users per second: 6848.59"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 23000/270892 queries. users per second: 6805.93</pre>"
      ],
      "text/plain": [
       "recommendations finished on 23000/270892 queries. users per second: 6805.93"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 24000/270892 queries. users per second: 6792.42</pre>"
      ],
      "text/plain": [
       "recommendations finished on 24000/270892 queries. users per second: 6792.42"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 25000/270892 queries. users per second: 6796.31</pre>"
      ],
      "text/plain": [
       "recommendations finished on 25000/270892 queries. users per second: 6796.31"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 26000/270892 queries. users per second: 6798.11</pre>"
      ],
      "text/plain": [
       "recommendations finished on 26000/270892 queries. users per second: 6798.11"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 27000/270892 queries. users per second: 6814.14</pre>"
      ],
      "text/plain": [
       "recommendations finished on 27000/270892 queries. users per second: 6814.14"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 28000/270892 queries. users per second: 6766.42</pre>"
      ],
      "text/plain": [
       "recommendations finished on 28000/270892 queries. users per second: 6766.42"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 29000/270892 queries. users per second: 6744.39</pre>"
      ],
      "text/plain": [
       "recommendations finished on 29000/270892 queries. users per second: 6744.39"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 30000/270892 queries. users per second: 6740.83</pre>"
      ],
      "text/plain": [
       "recommendations finished on 30000/270892 queries. users per second: 6740.83"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 31000/270892 queries. users per second: 6744.68</pre>"
      ],
      "text/plain": [
       "recommendations finished on 31000/270892 queries. users per second: 6744.68"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 32000/270892 queries. users per second: 6747.4</pre>"
      ],
      "text/plain": [
       "recommendations finished on 32000/270892 queries. users per second: 6747.4"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 33000/270892 queries. users per second: 6731.46</pre>"
      ],
      "text/plain": [
       "recommendations finished on 33000/270892 queries. users per second: 6731.46"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 34000/270892 queries. users per second: 6682.12</pre>"
      ],
      "text/plain": [
       "recommendations finished on 34000/270892 queries. users per second: 6682.12"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 35000/270892 queries. users per second: 6631.39</pre>"
      ],
      "text/plain": [
       "recommendations finished on 35000/270892 queries. users per second: 6631.39"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 36000/270892 queries. users per second: 6612.51</pre>"
      ],
      "text/plain": [
       "recommendations finished on 36000/270892 queries. users per second: 6612.51"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 37000/270892 queries. users per second: 6563.99</pre>"
      ],
      "text/plain": [
       "recommendations finished on 37000/270892 queries. users per second: 6563.99"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 38000/270892 queries. users per second: 6501.8</pre>"
      ],
      "text/plain": [
       "recommendations finished on 38000/270892 queries. users per second: 6501.8"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 39000/270892 queries. users per second: 6461.05</pre>"
      ],
      "text/plain": [
       "recommendations finished on 39000/270892 queries. users per second: 6461.05"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 40000/270892 queries. users per second: 6390.26</pre>"
      ],
      "text/plain": [
       "recommendations finished on 40000/270892 queries. users per second: 6390.26"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 41000/270892 queries. users per second: 6359.22</pre>"
      ],
      "text/plain": [
       "recommendations finished on 41000/270892 queries. users per second: 6359.22"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 42000/270892 queries. users per second: 6326.15</pre>"
      ],
      "text/plain": [
       "recommendations finished on 42000/270892 queries. users per second: 6326.15"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 43000/270892 queries. users per second: 6304.59</pre>"
      ],
      "text/plain": [
       "recommendations finished on 43000/270892 queries. users per second: 6304.59"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 44000/270892 queries. users per second: 6281.56</pre>"
      ],
      "text/plain": [
       "recommendations finished on 44000/270892 queries. users per second: 6281.56"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 45000/270892 queries. users per second: 6261.22</pre>"
      ],
      "text/plain": [
       "recommendations finished on 45000/270892 queries. users per second: 6261.22"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 46000/270892 queries. users per second: 6253.88</pre>"
      ],
      "text/plain": [
       "recommendations finished on 46000/270892 queries. users per second: 6253.88"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 47000/270892 queries. users per second: 6243.36</pre>"
      ],
      "text/plain": [
       "recommendations finished on 47000/270892 queries. users per second: 6243.36"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 48000/270892 queries. users per second: 6240.45</pre>"
      ],
      "text/plain": [
       "recommendations finished on 48000/270892 queries. users per second: 6240.45"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 49000/270892 queries. users per second: 6232.65</pre>"
      ],
      "text/plain": [
       "recommendations finished on 49000/270892 queries. users per second: 6232.65"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 50000/270892 queries. users per second: 6231.35</pre>"
      ],
      "text/plain": [
       "recommendations finished on 50000/270892 queries. users per second: 6231.35"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 51000/270892 queries. users per second: 6216.68</pre>"
      ],
      "text/plain": [
       "recommendations finished on 51000/270892 queries. users per second: 6216.68"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 52000/270892 queries. users per second: 6217.15</pre>"
      ],
      "text/plain": [
       "recommendations finished on 52000/270892 queries. users per second: 6217.15"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 53000/270892 queries. users per second: 6205.8</pre>"
      ],
      "text/plain": [
       "recommendations finished on 53000/270892 queries. users per second: 6205.8"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 54000/270892 queries. users per second: 6208.71</pre>"
      ],
      "text/plain": [
       "recommendations finished on 54000/270892 queries. users per second: 6208.71"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 55000/270892 queries. users per second: 6205.65</pre>"
      ],
      "text/plain": [
       "recommendations finished on 55000/270892 queries. users per second: 6205.65"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 56000/270892 queries. users per second: 6191.95</pre>"
      ],
      "text/plain": [
       "recommendations finished on 56000/270892 queries. users per second: 6191.95"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 57000/270892 queries. users per second: 6189.73</pre>"
      ],
      "text/plain": [
       "recommendations finished on 57000/270892 queries. users per second: 6189.73"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 58000/270892 queries. users per second: 6193.41</pre>"
      ],
      "text/plain": [
       "recommendations finished on 58000/270892 queries. users per second: 6193.41"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 59000/270892 queries. users per second: 6194.53</pre>"
      ],
      "text/plain": [
       "recommendations finished on 59000/270892 queries. users per second: 6194.53"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 60000/270892 queries. users per second: 6198.53</pre>"
      ],
      "text/plain": [
       "recommendations finished on 60000/270892 queries. users per second: 6198.53"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 61000/270892 queries. users per second: 6189.98</pre>"
      ],
      "text/plain": [
       "recommendations finished on 61000/270892 queries. users per second: 6189.98"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 62000/270892 queries. users per second: 6182.01</pre>"
      ],
      "text/plain": [
       "recommendations finished on 62000/270892 queries. users per second: 6182.01"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 63000/270892 queries. users per second: 6159.73</pre>"
      ],
      "text/plain": [
       "recommendations finished on 63000/270892 queries. users per second: 6159.73"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 64000/270892 queries. users per second: 6156.37</pre>"
      ],
      "text/plain": [
       "recommendations finished on 64000/270892 queries. users per second: 6156.37"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 65000/270892 queries. users per second: 6147.43</pre>"
      ],
      "text/plain": [
       "recommendations finished on 65000/270892 queries. users per second: 6147.43"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 66000/270892 queries. users per second: 6142.36</pre>"
      ],
      "text/plain": [
       "recommendations finished on 66000/270892 queries. users per second: 6142.36"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 67000/270892 queries. users per second: 6139.71</pre>"
      ],
      "text/plain": [
       "recommendations finished on 67000/270892 queries. users per second: 6139.71"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 68000/270892 queries. users per second: 6134.99</pre>"
      ],
      "text/plain": [
       "recommendations finished on 68000/270892 queries. users per second: 6134.99"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 69000/270892 queries. users per second: 6124.65</pre>"
      ],
      "text/plain": [
       "recommendations finished on 69000/270892 queries. users per second: 6124.65"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 70000/270892 queries. users per second: 6119.02</pre>"
      ],
      "text/plain": [
       "recommendations finished on 70000/270892 queries. users per second: 6119.02"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 71000/270892 queries. users per second: 6113.27</pre>"
      ],
      "text/plain": [
       "recommendations finished on 71000/270892 queries. users per second: 6113.27"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 72000/270892 queries. users per second: 6109.68</pre>"
      ],
      "text/plain": [
       "recommendations finished on 72000/270892 queries. users per second: 6109.68"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 73000/270892 queries. users per second: 6104.09</pre>"
      ],
      "text/plain": [
       "recommendations finished on 73000/270892 queries. users per second: 6104.09"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 74000/270892 queries. users per second: 6077.91</pre>"
      ],
      "text/plain": [
       "recommendations finished on 74000/270892 queries. users per second: 6077.91"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 75000/270892 queries. users per second: 6064.1</pre>"
      ],
      "text/plain": [
       "recommendations finished on 75000/270892 queries. users per second: 6064.1"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 76000/270892 queries. users per second: 6042.48</pre>"
      ],
      "text/plain": [
       "recommendations finished on 76000/270892 queries. users per second: 6042.48"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 77000/270892 queries. users per second: 6037.46</pre>"
      ],
      "text/plain": [
       "recommendations finished on 77000/270892 queries. users per second: 6037.46"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 78000/270892 queries. users per second: 6035.44</pre>"
      ],
      "text/plain": [
       "recommendations finished on 78000/270892 queries. users per second: 6035.44"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 79000/270892 queries. users per second: 6032.25</pre>"
      ],
      "text/plain": [
       "recommendations finished on 79000/270892 queries. users per second: 6032.25"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 80000/270892 queries. users per second: 6018.89</pre>"
      ],
      "text/plain": [
       "recommendations finished on 80000/270892 queries. users per second: 6018.89"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 81000/270892 queries. users per second: 5993.18</pre>"
      ],
      "text/plain": [
       "recommendations finished on 81000/270892 queries. users per second: 5993.18"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 82000/270892 queries. users per second: 5985.32</pre>"
      ],
      "text/plain": [
       "recommendations finished on 82000/270892 queries. users per second: 5985.32"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 83000/270892 queries. users per second: 5978.96</pre>"
      ],
      "text/plain": [
       "recommendations finished on 83000/270892 queries. users per second: 5978.96"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 84000/270892 queries. users per second: 5975.43</pre>"
      ],
      "text/plain": [
       "recommendations finished on 84000/270892 queries. users per second: 5975.43"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 85000/270892 queries. users per second: 5950.79</pre>"
      ],
      "text/plain": [
       "recommendations finished on 85000/270892 queries. users per second: 5950.79"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 86000/270892 queries. users per second: 5941.37</pre>"
      ],
      "text/plain": [
       "recommendations finished on 86000/270892 queries. users per second: 5941.37"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 87000/270892 queries. users per second: 5928.76</pre>"
      ],
      "text/plain": [
       "recommendations finished on 87000/270892 queries. users per second: 5928.76"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 88000/270892 queries. users per second: 5921.81</pre>"
      ],
      "text/plain": [
       "recommendations finished on 88000/270892 queries. users per second: 5921.81"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 89000/270892 queries. users per second: 5914.51</pre>"
      ],
      "text/plain": [
       "recommendations finished on 89000/270892 queries. users per second: 5914.51"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 90000/270892 queries. users per second: 5910.83</pre>"
      ],
      "text/plain": [
       "recommendations finished on 90000/270892 queries. users per second: 5910.83"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 91000/270892 queries. users per second: 5903.58</pre>"
      ],
      "text/plain": [
       "recommendations finished on 91000/270892 queries. users per second: 5903.58"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 92000/270892 queries. users per second: 5894.47</pre>"
      ],
      "text/plain": [
       "recommendations finished on 92000/270892 queries. users per second: 5894.47"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 93000/270892 queries. users per second: 5879.58</pre>"
      ],
      "text/plain": [
       "recommendations finished on 93000/270892 queries. users per second: 5879.58"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 94000/270892 queries. users per second: 5869.42</pre>"
      ],
      "text/plain": [
       "recommendations finished on 94000/270892 queries. users per second: 5869.42"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 95000/270892 queries. users per second: 5845.31</pre>"
      ],
      "text/plain": [
       "recommendations finished on 95000/270892 queries. users per second: 5845.31"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 96000/270892 queries. users per second: 5812.97</pre>"
      ],
      "text/plain": [
       "recommendations finished on 96000/270892 queries. users per second: 5812.97"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 97000/270892 queries. users per second: 5802.41</pre>"
      ],
      "text/plain": [
       "recommendations finished on 97000/270892 queries. users per second: 5802.41"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 98000/270892 queries. users per second: 5787.78</pre>"
      ],
      "text/plain": [
       "recommendations finished on 98000/270892 queries. users per second: 5787.78"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 99000/270892 queries. users per second: 5778.69</pre>"
      ],
      "text/plain": [
       "recommendations finished on 99000/270892 queries. users per second: 5778.69"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 100000/270892 queries. users per second: 5764.11</pre>"
      ],
      "text/plain": [
       "recommendations finished on 100000/270892 queries. users per second: 5764.11"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 101000/270892 queries. users per second: 5754.68</pre>"
      ],
      "text/plain": [
       "recommendations finished on 101000/270892 queries. users per second: 5754.68"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 102000/270892 queries. users per second: 5740.07</pre>"
      ],
      "text/plain": [
       "recommendations finished on 102000/270892 queries. users per second: 5740.07"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 103000/270892 queries. users per second: 5718.87</pre>"
      ],
      "text/plain": [
       "recommendations finished on 103000/270892 queries. users per second: 5718.87"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 104000/270892 queries. users per second: 5702.4</pre>"
      ],
      "text/plain": [
       "recommendations finished on 104000/270892 queries. users per second: 5702.4"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 105000/270892 queries. users per second: 5689.33</pre>"
      ],
      "text/plain": [
       "recommendations finished on 105000/270892 queries. users per second: 5689.33"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 106000/270892 queries. users per second: 5678.06</pre>"
      ],
      "text/plain": [
       "recommendations finished on 106000/270892 queries. users per second: 5678.06"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 107000/270892 queries. users per second: 5666.84</pre>"
      ],
      "text/plain": [
       "recommendations finished on 107000/270892 queries. users per second: 5666.84"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 108000/270892 queries. users per second: 5661.25</pre>"
      ],
      "text/plain": [
       "recommendations finished on 108000/270892 queries. users per second: 5661.25"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 109000/270892 queries. users per second: 5653.26</pre>"
      ],
      "text/plain": [
       "recommendations finished on 109000/270892 queries. users per second: 5653.26"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 110000/270892 queries. users per second: 5648.61</pre>"
      ],
      "text/plain": [
       "recommendations finished on 110000/270892 queries. users per second: 5648.61"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 111000/270892 queries. users per second: 5641.46</pre>"
      ],
      "text/plain": [
       "recommendations finished on 111000/270892 queries. users per second: 5641.46"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 112000/270892 queries. users per second: 5636.22</pre>"
      ],
      "text/plain": [
       "recommendations finished on 112000/270892 queries. users per second: 5636.22"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 113000/270892 queries. users per second: 5624.7</pre>"
      ],
      "text/plain": [
       "recommendations finished on 113000/270892 queries. users per second: 5624.7"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 114000/270892 queries. users per second: 5620.99</pre>"
      ],
      "text/plain": [
       "recommendations finished on 114000/270892 queries. users per second: 5620.99"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 115000/270892 queries. users per second: 5611.65</pre>"
      ],
      "text/plain": [
       "recommendations finished on 115000/270892 queries. users per second: 5611.65"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 116000/270892 queries. users per second: 5601.61</pre>"
      ],
      "text/plain": [
       "recommendations finished on 116000/270892 queries. users per second: 5601.61"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 117000/270892 queries. users per second: 5595.7</pre>"
      ],
      "text/plain": [
       "recommendations finished on 117000/270892 queries. users per second: 5595.7"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 118000/270892 queries. users per second: 5592.27</pre>"
      ],
      "text/plain": [
       "recommendations finished on 118000/270892 queries. users per second: 5592.27"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 119000/270892 queries. users per second: 5584.64</pre>"
      ],
      "text/plain": [
       "recommendations finished on 119000/270892 queries. users per second: 5584.64"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 120000/270892 queries. users per second: 5572.07</pre>"
      ],
      "text/plain": [
       "recommendations finished on 120000/270892 queries. users per second: 5572.07"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 121000/270892 queries. users per second: 5570.51</pre>"
      ],
      "text/plain": [
       "recommendations finished on 121000/270892 queries. users per second: 5570.51"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 122000/270892 queries. users per second: 5565.52</pre>"
      ],
      "text/plain": [
       "recommendations finished on 122000/270892 queries. users per second: 5565.52"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 123000/270892 queries. users per second: 5560.31</pre>"
      ],
      "text/plain": [
       "recommendations finished on 123000/270892 queries. users per second: 5560.31"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 124000/270892 queries. users per second: 5557.04</pre>"
      ],
      "text/plain": [
       "recommendations finished on 124000/270892 queries. users per second: 5557.04"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 125000/270892 queries. users per second: 5542.91</pre>"
      ],
      "text/plain": [
       "recommendations finished on 125000/270892 queries. users per second: 5542.91"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 126000/270892 queries. users per second: 5534.68</pre>"
      ],
      "text/plain": [
       "recommendations finished on 126000/270892 queries. users per second: 5534.68"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 127000/270892 queries. users per second: 5516.71</pre>"
      ],
      "text/plain": [
       "recommendations finished on 127000/270892 queries. users per second: 5516.71"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 128000/270892 queries. users per second: 5493.29</pre>"
      ],
      "text/plain": [
       "recommendations finished on 128000/270892 queries. users per second: 5493.29"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 129000/270892 queries. users per second: 5471.69</pre>"
      ],
      "text/plain": [
       "recommendations finished on 129000/270892 queries. users per second: 5471.69"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 130000/270892 queries. users per second: 5443.07</pre>"
      ],
      "text/plain": [
       "recommendations finished on 130000/270892 queries. users per second: 5443.07"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 131000/270892 queries. users per second: 5437.71</pre>"
      ],
      "text/plain": [
       "recommendations finished on 131000/270892 queries. users per second: 5437.71"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 132000/270892 queries. users per second: 5437.72</pre>"
      ],
      "text/plain": [
       "recommendations finished on 132000/270892 queries. users per second: 5437.72"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 133000/270892 queries. users per second: 5428.83</pre>"
      ],
      "text/plain": [
       "recommendations finished on 133000/270892 queries. users per second: 5428.83"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 134000/270892 queries. users per second: 5416.37</pre>"
      ],
      "text/plain": [
       "recommendations finished on 134000/270892 queries. users per second: 5416.37"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 135000/270892 queries. users per second: 5416.5</pre>"
      ],
      "text/plain": [
       "recommendations finished on 135000/270892 queries. users per second: 5416.5"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 136000/270892 queries. users per second: 5416.67</pre>"
      ],
      "text/plain": [
       "recommendations finished on 136000/270892 queries. users per second: 5416.67"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 137000/270892 queries. users per second: 5416.65</pre>"
      ],
      "text/plain": [
       "recommendations finished on 137000/270892 queries. users per second: 5416.65"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 138000/270892 queries. users per second: 5410.31</pre>"
      ],
      "text/plain": [
       "recommendations finished on 138000/270892 queries. users per second: 5410.31"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 139000/270892 queries. users per second: 5402.61</pre>"
      ],
      "text/plain": [
       "recommendations finished on 139000/270892 queries. users per second: 5402.61"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 140000/270892 queries. users per second: 5400.86</pre>"
      ],
      "text/plain": [
       "recommendations finished on 140000/270892 queries. users per second: 5400.86"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 141000/270892 queries. users per second: 5394.29</pre>"
      ],
      "text/plain": [
       "recommendations finished on 141000/270892 queries. users per second: 5394.29"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 142000/270892 queries. users per second: 5391.6</pre>"
      ],
      "text/plain": [
       "recommendations finished on 142000/270892 queries. users per second: 5391.6"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 143000/270892 queries. users per second: 5383.06</pre>"
      ],
      "text/plain": [
       "recommendations finished on 143000/270892 queries. users per second: 5383.06"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 144000/270892 queries. users per second: 5377.23</pre>"
      ],
      "text/plain": [
       "recommendations finished on 144000/270892 queries. users per second: 5377.23"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 145000/270892 queries. users per second: 5368.32</pre>"
      ],
      "text/plain": [
       "recommendations finished on 145000/270892 queries. users per second: 5368.32"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 146000/270892 queries. users per second: 5367.97</pre>"
      ],
      "text/plain": [
       "recommendations finished on 146000/270892 queries. users per second: 5367.97"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 147000/270892 queries. users per second: 5363.57</pre>"
      ],
      "text/plain": [
       "recommendations finished on 147000/270892 queries. users per second: 5363.57"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 148000/270892 queries. users per second: 5355.99</pre>"
      ],
      "text/plain": [
       "recommendations finished on 148000/270892 queries. users per second: 5355.99"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 149000/270892 queries. users per second: 5353.88</pre>"
      ],
      "text/plain": [
       "recommendations finished on 149000/270892 queries. users per second: 5353.88"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 150000/270892 queries. users per second: 5346.91</pre>"
      ],
      "text/plain": [
       "recommendations finished on 150000/270892 queries. users per second: 5346.91"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 151000/270892 queries. users per second: 5341.9</pre>"
      ],
      "text/plain": [
       "recommendations finished on 151000/270892 queries. users per second: 5341.9"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 152000/270892 queries. users per second: 5338.28</pre>"
      ],
      "text/plain": [
       "recommendations finished on 152000/270892 queries. users per second: 5338.28"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 153000/270892 queries. users per second: 5329.79</pre>"
      ],
      "text/plain": [
       "recommendations finished on 153000/270892 queries. users per second: 5329.79"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 154000/270892 queries. users per second: 5324.82</pre>"
      ],
      "text/plain": [
       "recommendations finished on 154000/270892 queries. users per second: 5324.82"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 155000/270892 queries. users per second: 5324.64</pre>"
      ],
      "text/plain": [
       "recommendations finished on 155000/270892 queries. users per second: 5324.64"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 156000/270892 queries. users per second: 5320.88</pre>"
      ],
      "text/plain": [
       "recommendations finished on 156000/270892 queries. users per second: 5320.88"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 157000/270892 queries. users per second: 5318.45</pre>"
      ],
      "text/plain": [
       "recommendations finished on 157000/270892 queries. users per second: 5318.45"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 158000/270892 queries. users per second: 5312.95</pre>"
      ],
      "text/plain": [
       "recommendations finished on 158000/270892 queries. users per second: 5312.95"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 159000/270892 queries. users per second: 5310</pre>"
      ],
      "text/plain": [
       "recommendations finished on 159000/270892 queries. users per second: 5310"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 160000/270892 queries. users per second: 5307.61</pre>"
      ],
      "text/plain": [
       "recommendations finished on 160000/270892 queries. users per second: 5307.61"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 161000/270892 queries. users per second: 5307.86</pre>"
      ],
      "text/plain": [
       "recommendations finished on 161000/270892 queries. users per second: 5307.86"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 162000/270892 queries. users per second: 5304.12</pre>"
      ],
      "text/plain": [
       "recommendations finished on 162000/270892 queries. users per second: 5304.12"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 163000/270892 queries. users per second: 5293.14</pre>"
      ],
      "text/plain": [
       "recommendations finished on 163000/270892 queries. users per second: 5293.14"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 164000/270892 queries. users per second: 5293.35</pre>"
      ],
      "text/plain": [
       "recommendations finished on 164000/270892 queries. users per second: 5293.35"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 165000/270892 queries. users per second: 5293.94</pre>"
      ],
      "text/plain": [
       "recommendations finished on 165000/270892 queries. users per second: 5293.94"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 166000/270892 queries. users per second: 5295.25</pre>"
      ],
      "text/plain": [
       "recommendations finished on 166000/270892 queries. users per second: 5295.25"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 167000/270892 queries. users per second: 5291.69</pre>"
      ],
      "text/plain": [
       "recommendations finished on 167000/270892 queries. users per second: 5291.69"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 168000/270892 queries. users per second: 5290.3</pre>"
      ],
      "text/plain": [
       "recommendations finished on 168000/270892 queries. users per second: 5290.3"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 169000/270892 queries. users per second: 5291.29</pre>"
      ],
      "text/plain": [
       "recommendations finished on 169000/270892 queries. users per second: 5291.29"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 170000/270892 queries. users per second: 5284.04</pre>"
      ],
      "text/plain": [
       "recommendations finished on 170000/270892 queries. users per second: 5284.04"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 171000/270892 queries. users per second: 5283.03</pre>"
      ],
      "text/plain": [
       "recommendations finished on 171000/270892 queries. users per second: 5283.03"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 172000/270892 queries. users per second: 5276.07</pre>"
      ],
      "text/plain": [
       "recommendations finished on 172000/270892 queries. users per second: 5276.07"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 173000/270892 queries. users per second: 5274.3</pre>"
      ],
      "text/plain": [
       "recommendations finished on 173000/270892 queries. users per second: 5274.3"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 174000/270892 queries. users per second: 5272.09</pre>"
      ],
      "text/plain": [
       "recommendations finished on 174000/270892 queries. users per second: 5272.09"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 175000/270892 queries. users per second: 5272.6</pre>"
      ],
      "text/plain": [
       "recommendations finished on 175000/270892 queries. users per second: 5272.6"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 176000/270892 queries. users per second: 5274.69</pre>"
      ],
      "text/plain": [
       "recommendations finished on 176000/270892 queries. users per second: 5274.69"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 177000/270892 queries. users per second: 5272.86</pre>"
      ],
      "text/plain": [
       "recommendations finished on 177000/270892 queries. users per second: 5272.86"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 178000/270892 queries. users per second: 5267.67</pre>"
      ],
      "text/plain": [
       "recommendations finished on 178000/270892 queries. users per second: 5267.67"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 179000/270892 queries. users per second: 5268.41</pre>"
      ],
      "text/plain": [
       "recommendations finished on 179000/270892 queries. users per second: 5268.41"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 180000/270892 queries. users per second: 5271.2</pre>"
      ],
      "text/plain": [
       "recommendations finished on 180000/270892 queries. users per second: 5271.2"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 181000/270892 queries. users per second: 5273.52</pre>"
      ],
      "text/plain": [
       "recommendations finished on 181000/270892 queries. users per second: 5273.52"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 182000/270892 queries. users per second: 5269.31</pre>"
      ],
      "text/plain": [
       "recommendations finished on 182000/270892 queries. users per second: 5269.31"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 183000/270892 queries. users per second: 5270.74</pre>"
      ],
      "text/plain": [
       "recommendations finished on 183000/270892 queries. users per second: 5270.74"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 184000/270892 queries. users per second: 5270.22</pre>"
      ],
      "text/plain": [
       "recommendations finished on 184000/270892 queries. users per second: 5270.22"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 185000/270892 queries. users per second: 5273.24</pre>"
      ],
      "text/plain": [
       "recommendations finished on 185000/270892 queries. users per second: 5273.24"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 186000/270892 queries. users per second: 5271.82</pre>"
      ],
      "text/plain": [
       "recommendations finished on 186000/270892 queries. users per second: 5271.82"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 187000/270892 queries. users per second: 5271.19</pre>"
      ],
      "text/plain": [
       "recommendations finished on 187000/270892 queries. users per second: 5271.19"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 188000/270892 queries. users per second: 5269.53</pre>"
      ],
      "text/plain": [
       "recommendations finished on 188000/270892 queries. users per second: 5269.53"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 189000/270892 queries. users per second: 5267.84</pre>"
      ],
      "text/plain": [
       "recommendations finished on 189000/270892 queries. users per second: 5267.84"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 190000/270892 queries. users per second: 5266.81</pre>"
      ],
      "text/plain": [
       "recommendations finished on 190000/270892 queries. users per second: 5266.81"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 191000/270892 queries. users per second: 5268.33</pre>"
      ],
      "text/plain": [
       "recommendations finished on 191000/270892 queries. users per second: 5268.33"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 192000/270892 queries. users per second: 5266.93</pre>"
      ],
      "text/plain": [
       "recommendations finished on 192000/270892 queries. users per second: 5266.93"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 193000/270892 queries. users per second: 5267.65</pre>"
      ],
      "text/plain": [
       "recommendations finished on 193000/270892 queries. users per second: 5267.65"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 194000/270892 queries. users per second: 5267.3</pre>"
      ],
      "text/plain": [
       "recommendations finished on 194000/270892 queries. users per second: 5267.3"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 195000/270892 queries. users per second: 5268.49</pre>"
      ],
      "text/plain": [
       "recommendations finished on 195000/270892 queries. users per second: 5268.49"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 196000/270892 queries. users per second: 5266.66</pre>"
      ],
      "text/plain": [
       "recommendations finished on 196000/270892 queries. users per second: 5266.66"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 197000/270892 queries. users per second: 5265.32</pre>"
      ],
      "text/plain": [
       "recommendations finished on 197000/270892 queries. users per second: 5265.32"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 198000/270892 queries. users per second: 5266.87</pre>"
      ],
      "text/plain": [
       "recommendations finished on 198000/270892 queries. users per second: 5266.87"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 199000/270892 queries. users per second: 5268.27</pre>"
      ],
      "text/plain": [
       "recommendations finished on 199000/270892 queries. users per second: 5268.27"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 200000/270892 queries. users per second: 5271.05</pre>"
      ],
      "text/plain": [
       "recommendations finished on 200000/270892 queries. users per second: 5271.05"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 201000/270892 queries. users per second: 5270.54</pre>"
      ],
      "text/plain": [
       "recommendations finished on 201000/270892 queries. users per second: 5270.54"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 202000/270892 queries. users per second: 5271.78</pre>"
      ],
      "text/plain": [
       "recommendations finished on 202000/270892 queries. users per second: 5271.78"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 203000/270892 queries. users per second: 5272.25</pre>"
      ],
      "text/plain": [
       "recommendations finished on 203000/270892 queries. users per second: 5272.25"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 204000/270892 queries. users per second: 5272.3</pre>"
      ],
      "text/plain": [
       "recommendations finished on 204000/270892 queries. users per second: 5272.3"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 205000/270892 queries. users per second: 5268.89</pre>"
      ],
      "text/plain": [
       "recommendations finished on 205000/270892 queries. users per second: 5268.89"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 206000/270892 queries. users per second: 5271.92</pre>"
      ],
      "text/plain": [
       "recommendations finished on 206000/270892 queries. users per second: 5271.92"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 207000/270892 queries. users per second: 5273.49</pre>"
      ],
      "text/plain": [
       "recommendations finished on 207000/270892 queries. users per second: 5273.49"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 208000/270892 queries. users per second: 5272.37</pre>"
      ],
      "text/plain": [
       "recommendations finished on 208000/270892 queries. users per second: 5272.37"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 209000/270892 queries. users per second: 5271.79</pre>"
      ],
      "text/plain": [
       "recommendations finished on 209000/270892 queries. users per second: 5271.79"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 210000/270892 queries. users per second: 5272.66</pre>"
      ],
      "text/plain": [
       "recommendations finished on 210000/270892 queries. users per second: 5272.66"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 211000/270892 queries. users per second: 5269.95</pre>"
      ],
      "text/plain": [
       "recommendations finished on 211000/270892 queries. users per second: 5269.95"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 212000/270892 queries. users per second: 5270.72</pre>"
      ],
      "text/plain": [
       "recommendations finished on 212000/270892 queries. users per second: 5270.72"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 213000/270892 queries. users per second: 5273.57</pre>"
      ],
      "text/plain": [
       "recommendations finished on 213000/270892 queries. users per second: 5273.57"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 214000/270892 queries. users per second: 5274.67</pre>"
      ],
      "text/plain": [
       "recommendations finished on 214000/270892 queries. users per second: 5274.67"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 215000/270892 queries. users per second: 5276.46</pre>"
      ],
      "text/plain": [
       "recommendations finished on 215000/270892 queries. users per second: 5276.46"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 216000/270892 queries. users per second: 5275.73</pre>"
      ],
      "text/plain": [
       "recommendations finished on 216000/270892 queries. users per second: 5275.73"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 217000/270892 queries. users per second: 5279.06</pre>"
      ],
      "text/plain": [
       "recommendations finished on 217000/270892 queries. users per second: 5279.06"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 218000/270892 queries. users per second: 5276.4</pre>"
      ],
      "text/plain": [
       "recommendations finished on 218000/270892 queries. users per second: 5276.4"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 219000/270892 queries. users per second: 5273.57</pre>"
      ],
      "text/plain": [
       "recommendations finished on 219000/270892 queries. users per second: 5273.57"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 220000/270892 queries. users per second: 5272.02</pre>"
      ],
      "text/plain": [
       "recommendations finished on 220000/270892 queries. users per second: 5272.02"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 221000/270892 queries. users per second: 5269.23</pre>"
      ],
      "text/plain": [
       "recommendations finished on 221000/270892 queries. users per second: 5269.23"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 222000/270892 queries. users per second: 5269.49</pre>"
      ],
      "text/plain": [
       "recommendations finished on 222000/270892 queries. users per second: 5269.49"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 223000/270892 queries. users per second: 5269.83</pre>"
      ],
      "text/plain": [
       "recommendations finished on 223000/270892 queries. users per second: 5269.83"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 224000/270892 queries. users per second: 5268.18</pre>"
      ],
      "text/plain": [
       "recommendations finished on 224000/270892 queries. users per second: 5268.18"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 225000/270892 queries. users per second: 5268.49</pre>"
      ],
      "text/plain": [
       "recommendations finished on 225000/270892 queries. users per second: 5268.49"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 226000/270892 queries. users per second: 5266.26</pre>"
      ],
      "text/plain": [
       "recommendations finished on 226000/270892 queries. users per second: 5266.26"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 227000/270892 queries. users per second: 5266.59</pre>"
      ],
      "text/plain": [
       "recommendations finished on 227000/270892 queries. users per second: 5266.59"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 228000/270892 queries. users per second: 5269.14</pre>"
      ],
      "text/plain": [
       "recommendations finished on 228000/270892 queries. users per second: 5269.14"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 229000/270892 queries. users per second: 5269.93</pre>"
      ],
      "text/plain": [
       "recommendations finished on 229000/270892 queries. users per second: 5269.93"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 230000/270892 queries. users per second: 5269.82</pre>"
      ],
      "text/plain": [
       "recommendations finished on 230000/270892 queries. users per second: 5269.82"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 231000/270892 queries. users per second: 5270.48</pre>"
      ],
      "text/plain": [
       "recommendations finished on 231000/270892 queries. users per second: 5270.48"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 232000/270892 queries. users per second: 5269.17</pre>"
      ],
      "text/plain": [
       "recommendations finished on 232000/270892 queries. users per second: 5269.17"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 233000/270892 queries. users per second: 5270.31</pre>"
      ],
      "text/plain": [
       "recommendations finished on 233000/270892 queries. users per second: 5270.31"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 234000/270892 queries. users per second: 5271.75</pre>"
      ],
      "text/plain": [
       "recommendations finished on 234000/270892 queries. users per second: 5271.75"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 235000/270892 queries. users per second: 5268.02</pre>"
      ],
      "text/plain": [
       "recommendations finished on 235000/270892 queries. users per second: 5268.02"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 236000/270892 queries. users per second: 5264.16</pre>"
      ],
      "text/plain": [
       "recommendations finished on 236000/270892 queries. users per second: 5264.16"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 237000/270892 queries. users per second: 5263.45</pre>"
      ],
      "text/plain": [
       "recommendations finished on 237000/270892 queries. users per second: 5263.45"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 238000/270892 queries. users per second: 5264.63</pre>"
      ],
      "text/plain": [
       "recommendations finished on 238000/270892 queries. users per second: 5264.63"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 239000/270892 queries. users per second: 5264.53</pre>"
      ],
      "text/plain": [
       "recommendations finished on 239000/270892 queries. users per second: 5264.53"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 240000/270892 queries. users per second: 5263.49</pre>"
      ],
      "text/plain": [
       "recommendations finished on 240000/270892 queries. users per second: 5263.49"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 241000/270892 queries. users per second: 5262.14</pre>"
      ],
      "text/plain": [
       "recommendations finished on 241000/270892 queries. users per second: 5262.14"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 242000/270892 queries. users per second: 5260.64</pre>"
      ],
      "text/plain": [
       "recommendations finished on 242000/270892 queries. users per second: 5260.64"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 243000/270892 queries. users per second: 5255.47</pre>"
      ],
      "text/plain": [
       "recommendations finished on 243000/270892 queries. users per second: 5255.47"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 244000/270892 queries. users per second: 5252.81</pre>"
      ],
      "text/plain": [
       "recommendations finished on 244000/270892 queries. users per second: 5252.81"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 245000/270892 queries. users per second: 5245.25</pre>"
      ],
      "text/plain": [
       "recommendations finished on 245000/270892 queries. users per second: 5245.25"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 246000/270892 queries. users per second: 5242.01</pre>"
      ],
      "text/plain": [
       "recommendations finished on 246000/270892 queries. users per second: 5242.01"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 247000/270892 queries. users per second: 5239.42</pre>"
      ],
      "text/plain": [
       "recommendations finished on 247000/270892 queries. users per second: 5239.42"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 248000/270892 queries. users per second: 5238.03</pre>"
      ],
      "text/plain": [
       "recommendations finished on 248000/270892 queries. users per second: 5238.03"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 249000/270892 queries. users per second: 5237.71</pre>"
      ],
      "text/plain": [
       "recommendations finished on 249000/270892 queries. users per second: 5237.71"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 250000/270892 queries. users per second: 5238.37</pre>"
      ],
      "text/plain": [
       "recommendations finished on 250000/270892 queries. users per second: 5238.37"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 251000/270892 queries. users per second: 5238.31</pre>"
      ],
      "text/plain": [
       "recommendations finished on 251000/270892 queries. users per second: 5238.31"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 252000/270892 queries. users per second: 5235.58</pre>"
      ],
      "text/plain": [
       "recommendations finished on 252000/270892 queries. users per second: 5235.58"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 253000/270892 queries. users per second: 5236.95</pre>"
      ],
      "text/plain": [
       "recommendations finished on 253000/270892 queries. users per second: 5236.95"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 254000/270892 queries. users per second: 5235.75</pre>"
      ],
      "text/plain": [
       "recommendations finished on 254000/270892 queries. users per second: 5235.75"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 255000/270892 queries. users per second: 5235.85</pre>"
      ],
      "text/plain": [
       "recommendations finished on 255000/270892 queries. users per second: 5235.85"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 256000/270892 queries. users per second: 5232.41</pre>"
      ],
      "text/plain": [
       "recommendations finished on 256000/270892 queries. users per second: 5232.41"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 257000/270892 queries. users per second: 5231.32</pre>"
      ],
      "text/plain": [
       "recommendations finished on 257000/270892 queries. users per second: 5231.32"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 258000/270892 queries. users per second: 5232.82</pre>"
      ],
      "text/plain": [
       "recommendations finished on 258000/270892 queries. users per second: 5232.82"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 259000/270892 queries. users per second: 5231.24</pre>"
      ],
      "text/plain": [
       "recommendations finished on 259000/270892 queries. users per second: 5231.24"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 260000/270892 queries. users per second: 5231.25</pre>"
      ],
      "text/plain": [
       "recommendations finished on 260000/270892 queries. users per second: 5231.25"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 261000/270892 queries. users per second: 5230.77</pre>"
      ],
      "text/plain": [
       "recommendations finished on 261000/270892 queries. users per second: 5230.77"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 262000/270892 queries. users per second: 5226.74</pre>"
      ],
      "text/plain": [
       "recommendations finished on 262000/270892 queries. users per second: 5226.74"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 263000/270892 queries. users per second: 5226.66</pre>"
      ],
      "text/plain": [
       "recommendations finished on 263000/270892 queries. users per second: 5226.66"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 264000/270892 queries. users per second: 5225.24</pre>"
      ],
      "text/plain": [
       "recommendations finished on 264000/270892 queries. users per second: 5225.24"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 265000/270892 queries. users per second: 5225.07</pre>"
      ],
      "text/plain": [
       "recommendations finished on 265000/270892 queries. users per second: 5225.07"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 266000/270892 queries. users per second: 5223.94</pre>"
      ],
      "text/plain": [
       "recommendations finished on 266000/270892 queries. users per second: 5223.94"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 267000/270892 queries. users per second: 5225.36</pre>"
      ],
      "text/plain": [
       "recommendations finished on 267000/270892 queries. users per second: 5225.36"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 268000/270892 queries. users per second: 5225.76</pre>"
      ],
      "text/plain": [
       "recommendations finished on 268000/270892 queries. users per second: 5225.76"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 269000/270892 queries. users per second: 5226.98</pre>"
      ],
      "text/plain": [
       "recommendations finished on 269000/270892 queries. users per second: 5226.98"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<pre>recommendations finished on 270000/270892 queries. users per second: 5226.44</pre>"
      ],
      "text/plain": [
       "recommendations finished on 270000/270892 queries. users per second: 5226.44"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<div style=\"max-height:1000px;max-width:1500px;overflow:auto;\"><table frame=\"box\" rules=\"cols\">\n",
       "    <tr>\n",
       "        <th style=\"padding-left: 1em; padding-right: 1em; text-align: center\">userId</th>\n",
       "        <th style=\"padding-left: 1em; padding-right: 1em; text-align: center\">movieId</th>\n",
       "        <th style=\"padding-left: 1em; padding-right: 1em; text-align: center\">score</th>\n",
       "        <th style=\"padding-left: 1em; padding-right: 1em; text-align: center\">rank</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">1</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">1196</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">0.11922633427160757</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">1</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">6874</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">0.11548204333693893</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">1</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">2571</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">0.11526993027439823</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">1</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">70286</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">0.1136740733076025</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">1</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">4993</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">0.11362289057837592</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">2</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">733</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">0.19690940596840598</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">2</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">736</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">0.17766729268160733</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">2</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">1</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">0.14605714787136426</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">2</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">1073</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">0.13910811055790295</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">2</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">95</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">0.1381078525023027</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">5</td>\n",
       "    </tr>\n",
       "</table>\n",
       "[1354460 rows x 4 columns]<br/>Note: Only the head of the SFrame is printed.<br/>You can use print_rows(num_rows=m, num_columns=n) to print more rows and columns.\n",
       "</div>"
      ],
      "text/plain": [
       "Columns:\n",
       "\tuserId\tint\n",
       "\tmovieId\tint\n",
       "\tscore\tfloat\n",
       "\trank\tint\n",
       "\n",
       "Rows: 1354460\n",
       "\n",
       "Data:\n",
       "+--------+---------+---------------------+------+\n",
       "| userId | movieId |        score        | rank |\n",
       "+--------+---------+---------------------+------+\n",
       "|   1    |   1196  | 0.11922633427160757 |  1   |\n",
       "|   1    |   6874  | 0.11548204333693893 |  2   |\n",
       "|   1    |   2571  | 0.11526993027439823 |  3   |\n",
       "|   1    |  70286  |  0.1136740733076025 |  4   |\n",
       "|   1    |   4993  | 0.11362289057837592 |  5   |\n",
       "|   2    |   733   | 0.19690940596840598 |  1   |\n",
       "|   2    |   736   | 0.17766729268160733 |  2   |\n",
       "|   2    |    1    | 0.14605714787136426 |  3   |\n",
       "|   2    |   1073  | 0.13910811055790295 |  4   |\n",
       "|   2    |    95   |  0.1381078525023027 |  5   |\n",
       "+--------+---------+---------------------+------+\n",
       "[1354460 rows x 4 columns]\n",
       "Note: Only the head of the SFrame is printed.\n",
       "You can use print_rows(num_rows=m, num_columns=n) to print more rows and columns."
      ]
     },
     "execution_count": 52,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "results = model.recommend(users=None,k=5)\n",
    "results"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2020-08-03T19:11:52.935676Z",
     "start_time": "2020-08-03T19:11:50.776092Z"
    },
    "scrolled": false
   },
   "outputs": [],
   "source": [
    "pd_items = tc.SFrame.read_csv('movielens/movies_metadata.csv')\n",
    "#pd_items = pd_items.rename({'id' : 'movieId'})\n",
    "#pd_items = pd_items.unpack('belongs_to_collection')\n",
    "#pd_items = pd_items.unpack('genres')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2020-08-03T19:27:56.950594Z",
     "start_time": "2020-08-03T19:27:56.938357Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div style=\"max-height:1000px;max-width:1500px;overflow:auto;\"><table frame=\"box\" rules=\"cols\">\n",
       "    <tr>\n",
       "        <th style=\"padding-left: 1em; padding-right: 1em; text-align: center\">genres</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;id&#x27;: 16, &#x27;name&#x27;:<br>&#x27;Animation&#x27;}, {&#x27;id&#x27;: 35, ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;id&#x27;: 12, &#x27;name&#x27;:<br>&#x27;Adventure&#x27;}, {&#x27;id&#x27;: 14, ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;id&#x27;: 10749, &#x27;name&#x27;:<br>&#x27;Romance&#x27;}, {&#x27;id&#x27;: 35, ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;id&#x27;: 35, &#x27;name&#x27;:<br>&#x27;Comedy&#x27;}, {&#x27;id&#x27;: 18, ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;id&#x27;: 35, &#x27;name&#x27;:<br>&#x27;Comedy&#x27;}] ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;id&#x27;: 28, &#x27;name&#x27;:<br>&#x27;Action&#x27;}, {&#x27;id&#x27;: 80, ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;id&#x27;: 35, &#x27;name&#x27;:<br>&#x27;Comedy&#x27;}, {&#x27;id&#x27;: 10749, ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;id&#x27;: 28, &#x27;name&#x27;:<br>&#x27;Action&#x27;}, {&#x27;id&#x27;: 12, ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;id&#x27;: 28, &#x27;name&#x27;:<br>&#x27;Action&#x27;}, {&#x27;id&#x27;: 12, ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;id&#x27;: 12, &#x27;name&#x27;:<br>&#x27;Adventure&#x27;}, {&#x27;id&#x27;: 28, ...</td>\n",
       "    </tr>\n",
       "</table>\n",
       "[45459 rows x 1 columns]<br/>Note: Only the head of the SFrame is printed.<br/>You can use print_rows(num_rows=m, num_columns=n) to print more rows and columns.\n",
       "</div>"
      ],
      "text/plain": [
       "Columns:\n",
       "\tgenres\tlist\n",
       "\n",
       "Rows: 45459\n",
       "\n",
       "Data:\n",
       "+--------------------------------+\n",
       "|             genres             |\n",
       "+--------------------------------+\n",
       "| [{'id': 16, 'name': 'Anima...  |\n",
       "| [{'id': 12, 'name': 'Adven...  |\n",
       "| [{'id': 10749, 'name': 'Ro...  |\n",
       "| [{'id': 35, 'name': 'Comed...  |\n",
       "| [{'id': 35, 'name': 'Comedy'}] |\n",
       "| [{'id': 28, 'name': 'Actio...  |\n",
       "| [{'id': 35, 'name': 'Comed...  |\n",
       "| [{'id': 28, 'name': 'Actio...  |\n",
       "| [{'id': 28, 'name': 'Actio...  |\n",
       "| [{'id': 12, 'name': 'Adven...  |\n",
       "+--------------------------------+\n",
       "[45459 rows x 1 columns]\n",
       "Note: Only the head of the SFrame is printed.\n",
       "You can use print_rows(num_rows=m, num_columns=n) to print more rows and columns."
      ]
     },
     "execution_count": 49,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd_items.select_columns(['genres'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2020-08-03T18:28:11.368710Z",
     "start_time": "2020-08-03T18:28:11.297865Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<pre>Preparing data set.</pre>"
      ],
      "text/plain": [
       "Preparing data set."
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "ename": "ToolkitError",
     "evalue": "Value encountered in column 'production_companies' is of type 'dictionary' cannot be mapped to a categorical value. Categorical values must be integer, strings, or None.",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mRuntimeError\u001b[0m                              Traceback (most recent call last)",
      "\u001b[0;32m~/opt/anaconda3/lib/python3.7/site-packages/turicreate/extensions.py\u001b[0m in \u001b[0;36m__run_class_function\u001b[0;34m(self, fnname, args, kwargs)\u001b[0m\n\u001b[1;32m    289\u001b[0m         \u001b[0;32mtry\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 290\u001b[0;31m             \u001b[0mret\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_tkclass\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcall_function\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mfnname\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0margument_dict\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    291\u001b[0m         \u001b[0;32mexcept\u001b[0m \u001b[0mRuntimeError\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0mexc\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32mcy_model.pyx\u001b[0m in \u001b[0;36mturicreate._cython.cy_model.UnityModel.call_function\u001b[0;34m()\u001b[0m\n",
      "\u001b[0;32mcy_model.pyx\u001b[0m in \u001b[0;36mturicreate._cython.cy_model.UnityModel.call_function\u001b[0;34m()\u001b[0m\n",
      "\u001b[0;31mRuntimeError\u001b[0m: Value encountered in column 'production_companies' is of type 'dictionary' cannot be mapped to a categorical value. Categorical values must be integer, strings, or None.",
      "\nDuring handling of the above exception, another exception occurred:\n",
      "\u001b[0;31mToolkitError\u001b[0m                              Traceback (most recent call last)",
      "\u001b[0;32m<ipython-input-16-e2ad13bf25a7>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[1;32m      1\u001b[0m m_side_info = tc.factorization_recommender.create(actions,target='rating',user_id='userId',item_id='movieId',\n\u001b[0;32m----> 2\u001b[0;31m                                           item_data=pd_items.select_columns(['movieId', 'production_companies']))\n\u001b[0m",
      "\u001b[0;32m~/opt/anaconda3/lib/python3.7/site-packages/turicreate/toolkits/recommender/factorization_recommender.py\u001b[0m in \u001b[0;36mcreate\u001b[0;34m(observation_data, user_id, item_id, target, user_data, item_data, num_factors, regularization, linear_regularization, side_data_factorization, nmf, binary_target, max_iterations, sgd_step_size, random_seed, solver, verbose, **kwargs)\u001b[0m\n\u001b[1;32m    237\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    238\u001b[0m     \u001b[0;32mwith\u001b[0m \u001b[0mQuietProgress\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mverbose\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 239\u001b[0;31m         \u001b[0mmodel_proxy\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtrain\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mobservation_data\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0muser_data\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mitem_data\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mopts\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mextra_data\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    240\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    241\u001b[0m     \u001b[0;32mreturn\u001b[0m \u001b[0mFactorizationRecommender\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mmodel_proxy\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/opt/anaconda3/lib/python3.7/site-packages/turicreate/extensions.py\u001b[0m in \u001b[0;36m<lambda>\u001b[0;34m(*args, **kwargs)\u001b[0m\n\u001b[1;32m    303\u001b[0m         \u001b[0;32melif\u001b[0m \u001b[0mname\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_functions\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    304\u001b[0m             \u001b[0;31m# is it a function?\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 305\u001b[0;31m             \u001b[0mret\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mlambda\u001b[0m \u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m__run_class_function\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mname\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    306\u001b[0m             ret.__doc__ = (\n\u001b[1;32m    307\u001b[0m                 \u001b[0;34m\"Name: \"\u001b[0m \u001b[0;34m+\u001b[0m \u001b[0mname\u001b[0m \u001b[0;34m+\u001b[0m \u001b[0;34m\"\\nParameters: \"\u001b[0m \u001b[0;34m+\u001b[0m \u001b[0mstr\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_functions\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mname\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m+\u001b[0m \u001b[0;34m\"\\n\"\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;32m~/opt/anaconda3/lib/python3.7/site-packages/turicreate/extensions.py\u001b[0m in \u001b[0;36m__run_class_function\u001b[0;34m(self, fnname, args, kwargs)\u001b[0m\n\u001b[1;32m    291\u001b[0m         \u001b[0;32mexcept\u001b[0m \u001b[0mRuntimeError\u001b[0m \u001b[0;32mas\u001b[0m \u001b[0mexc\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    292\u001b[0m             \u001b[0;31m# Expose C++ exceptions using ToolkitError.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 293\u001b[0;31m             \u001b[0;32mraise\u001b[0m \u001b[0m_ToolkitError\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mexc\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    294\u001b[0m         \u001b[0mret\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0m_wrap_function_return\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mret\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    295\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mret\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n",
      "\u001b[0;31mToolkitError\u001b[0m: Value encountered in column 'production_companies' is of type 'dictionary' cannot be mapped to a categorical value. Categorical values must be integer, strings, or None."
     ]
    }
   ],
   "source": [
    "m_side_info = tc.factorization_recommender.create(actions,target='rating',user_id='userId',item_id='movieId',\n",
    "                                          item_data=pd_items.select_columns(['movieId', 'production_companies']))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2020-08-03T18:27:53.808776Z",
     "start_time": "2020-08-03T18:27:53.703716Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div style=\"max-height:1000px;max-width:1500px;overflow:auto;\"><table frame=\"box\" rules=\"cols\">\n",
       "    <tr>\n",
       "        <th style=\"padding-left: 1em; padding-right: 1em; text-align: center\">adult</th>\n",
       "        <th style=\"padding-left: 1em; padding-right: 1em; text-align: center\">belongs_to_collection</th>\n",
       "        <th style=\"padding-left: 1em; padding-right: 1em; text-align: center\">budget</th>\n",
       "        <th style=\"padding-left: 1em; padding-right: 1em; text-align: center\">genres</th>\n",
       "        <th style=\"padding-left: 1em; padding-right: 1em; text-align: center\">homepage</th>\n",
       "        <th style=\"padding-left: 1em; padding-right: 1em; text-align: center\">id</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">False</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">{&#x27;id&#x27;: 10194, &#x27;name&#x27;:<br>&#x27;Toy Story Collection&#x27;, ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">30000000</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;id&#x27;: 16, &#x27;name&#x27;:<br>&#x27;Animation&#x27;}, {&#x27;id&#x27;: 35, ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">http://toystory.disney.co<br>m/toy-story ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">862</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">False</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">None</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">65000000</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;id&#x27;: 12, &#x27;name&#x27;:<br>&#x27;Adventure&#x27;}, {&#x27;id&#x27;: 14, ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\"></td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">8844</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">False</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">{&#x27;id&#x27;: 119050, &#x27;name&#x27;:<br>&#x27;Grumpy Old Men ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">0</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;id&#x27;: 10749, &#x27;name&#x27;:<br>&#x27;Romance&#x27;}, {&#x27;id&#x27;: 35, ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\"></td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">15602</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">False</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">None</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">16000000</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;id&#x27;: 35, &#x27;name&#x27;:<br>&#x27;Comedy&#x27;}, {&#x27;id&#x27;: 18, ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\"></td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">31357</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">False</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">{&#x27;id&#x27;: 96871, &#x27;name&#x27;:<br>&#x27;Father of the Bride ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">0</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;id&#x27;: 35, &#x27;name&#x27;:<br>&#x27;Comedy&#x27;}] ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\"></td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">11862</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">False</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">None</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">60000000</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;id&#x27;: 28, &#x27;name&#x27;:<br>&#x27;Action&#x27;}, {&#x27;id&#x27;: 80, ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\"></td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">949</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">False</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">None</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">58000000</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;id&#x27;: 35, &#x27;name&#x27;:<br>&#x27;Comedy&#x27;}, {&#x27;id&#x27;: 10749, ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\"></td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">11860</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">False</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">None</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">0</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;id&#x27;: 28, &#x27;name&#x27;:<br>&#x27;Action&#x27;}, {&#x27;id&#x27;: 12, ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\"></td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">45325</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">False</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">None</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">35000000</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;id&#x27;: 28, &#x27;name&#x27;:<br>&#x27;Action&#x27;}, {&#x27;id&#x27;: 12, ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\"></td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">9091</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">False</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">{&#x27;id&#x27;: 645, &#x27;name&#x27;:<br>&#x27;James Bond Collection&#x27;, ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">58000000</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;id&#x27;: 12, &#x27;name&#x27;:<br>&#x27;Adventure&#x27;}, {&#x27;id&#x27;: 28, ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">http://www.mgm.com/view/m<br>ovie/757/Goldeneye/ ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">710</td>\n",
       "    </tr>\n",
       "</table>\n",
       "<table frame=\"box\" rules=\"cols\">\n",
       "    <tr>\n",
       "        <th style=\"padding-left: 1em; padding-right: 1em; text-align: center\">imdb_id</th>\n",
       "        <th style=\"padding-left: 1em; padding-right: 1em; text-align: center\">original_language</th>\n",
       "        <th style=\"padding-left: 1em; padding-right: 1em; text-align: center\">original_title</th>\n",
       "        <th style=\"padding-left: 1em; padding-right: 1em; text-align: center\">overview</th>\n",
       "        <th style=\"padding-left: 1em; padding-right: 1em; text-align: center\">popularity</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">tt0114709</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">en</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">Toy Story</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">Led by Woody, Andy&#x27;s toys<br>live happily in his room ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">21.946943</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">tt0113497</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">en</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">Jumanji</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">When siblings Judy and<br>Peter discover an ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">17.015539</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">tt0113228</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">en</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">Grumpier Old Men</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">A family wedding<br>reignites the ancient ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">11.7129</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">tt0114885</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">en</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">Waiting to Exhale</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">Cheated on, mistreated<br>and stepped on, the w ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">3.859495</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">tt0113041</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">en</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">Father of the Bride Part<br>II ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">Just when George Banks<br>has recovered from his ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">8.387519</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">tt0113277</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">en</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">Heat</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">Obsessive master thief,<br>Neil McCauley leads a ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">17.924927</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">tt0114319</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">en</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">Sabrina</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">An ugly duckling having<br>undergone a remarkable ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">6.677277</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">tt0112302</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">en</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">Tom and Huck</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">A mischievous young boy,<br>Tom Sawyer, witnesses a ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">2.561161</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">tt0114576</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">en</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">Sudden Death</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">International action<br>superstar Jean Claude ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">5.23158</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">tt0113189</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">en</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">GoldenEye</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">James Bond must unmask<br>the mysterious head of ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">14.686036</td>\n",
       "    </tr>\n",
       "</table>\n",
       "<table frame=\"box\" rules=\"cols\">\n",
       "    <tr>\n",
       "        <th style=\"padding-left: 1em; padding-right: 1em; text-align: center\">poster_path</th>\n",
       "        <th style=\"padding-left: 1em; padding-right: 1em; text-align: center\">production_companies</th>\n",
       "        <th style=\"padding-left: 1em; padding-right: 1em; text-align: center\">production_countries</th>\n",
       "        <th style=\"padding-left: 1em; padding-right: 1em; text-align: center\">release_date</th>\n",
       "        <th style=\"padding-left: 1em; padding-right: 1em; text-align: center\">revenue</th>\n",
       "        <th style=\"padding-left: 1em; padding-right: 1em; text-align: center\">runtime</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">/rhIRbceoE9lR4veEXuwCC2wA<br>RtG.jpg ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;name&#x27;: &#x27;Pixar<br>Animation Studios&#x27;, &#x27; ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;iso_3166_1&#x27;: &#x27;US&#x27;,<br>&#x27;name&#x27;: &#x27;United State ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">1995-10-30</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">373554033</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">81.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">/vzmL6fP7aPKNKPRTFnZmiUfc<br>iyV.jpg ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;name&#x27;: &#x27;TriStar<br>Pictures&#x27;, &#x27;id&#x27;: 559}, ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;iso_3166_1&#x27;: &#x27;US&#x27;,<br>&#x27;name&#x27;: &#x27;United State ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">1995-12-15</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">262797249</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">104.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">/6ksm1sjKMFLbO7UY2i6G1ju9<br>SML.jpg ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;name&#x27;: &#x27;Warner Bros.&#x27;,<br>&#x27;id&#x27;: 6194}, {&#x27;name&#x27;: ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;iso_3166_1&#x27;: &#x27;US&#x27;,<br>&#x27;name&#x27;: &#x27;United State ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">1995-12-22</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">0</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">101.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">/16XOMpEaLWkrcPqSQqhTmeJu<br>qQl.jpg ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;name&#x27;: &#x27;Twentieth<br>Century Fox Film ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;iso_3166_1&#x27;: &#x27;US&#x27;,<br>&#x27;name&#x27;: &#x27;United State ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">1995-12-22</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">81452156</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">127.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">/e64sOI48hQXyru7naBFyssKF<br>xVd.jpg ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;name&#x27;: &#x27;Sandollar<br>Productions&#x27;, &#x27;id&#x27;: ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;iso_3166_1&#x27;: &#x27;US&#x27;,<br>&#x27;name&#x27;: &#x27;United State ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">1995-02-10</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">76578911</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">106.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">/zMyfPUelumio3tiDKPffaUps<br>QTD.jpg ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;name&#x27;: &#x27;Regency<br>Enterprises&#x27;, &#x27;id&#x27;: 5 ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;iso_3166_1&#x27;: &#x27;US&#x27;,<br>&#x27;name&#x27;: &#x27;United State ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">1995-12-15</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">187436818</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">170.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">/jQh15y5YB7bWz1NtffNZmRw0<br>s9D.jpg ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;name&#x27;: &#x27;Paramount<br>Pictures&#x27;, &#x27;id&#x27;: 4}, ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;iso_3166_1&#x27;: &#x27;DE&#x27;,<br>&#x27;name&#x27;: &#x27;Germany&#x27;}, ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">1995-12-15</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">0</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">127.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">/sGO5Qa55p7wTu7FJcX4H4xIV<br>KvS.jpg ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;name&#x27;: &#x27;Walt Disney<br>Pictures&#x27;, &#x27;id&#x27;: 2}] ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;iso_3166_1&#x27;: &#x27;US&#x27;,<br>&#x27;name&#x27;: &#x27;United State ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">1995-12-22</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">0</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">97.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">/eoWvKD60lT95Ss1MYNgVExpo<br>5iU.jpg ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;name&#x27;: &#x27;Universal<br>Pictures&#x27;, &#x27;id&#x27;: 33}, ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;iso_3166_1&#x27;: &#x27;US&#x27;,<br>&#x27;name&#x27;: &#x27;United State ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">1995-12-22</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">64350171</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">106.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">/5c0ovjT41KnYIHYuF4AWsTe3<br>sKh.jpg ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;name&#x27;: &#x27;United<br>Artists&#x27;, &#x27;id&#x27;: 60}, ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;iso_3166_1&#x27;: &#x27;GB&#x27;,<br>&#x27;name&#x27;: &#x27;United ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">1995-11-16</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">352194034</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">130.0</td>\n",
       "    </tr>\n",
       "</table>\n",
       "<table frame=\"box\" rules=\"cols\">\n",
       "    <tr>\n",
       "        <th style=\"padding-left: 1em; padding-right: 1em; text-align: center\">spoken_languages</th>\n",
       "        <th style=\"padding-left: 1em; padding-right: 1em; text-align: center\">status</th>\n",
       "        <th style=\"padding-left: 1em; padding-right: 1em; text-align: center\">tagline</th>\n",
       "        <th style=\"padding-left: 1em; padding-right: 1em; text-align: center\">title</th>\n",
       "        <th style=\"padding-left: 1em; padding-right: 1em; text-align: center\">video</th>\n",
       "        <th style=\"padding-left: 1em; padding-right: 1em; text-align: center\">vote_average</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;iso_639_1&#x27;: &#x27;en&#x27;,<br>&#x27;name&#x27;: &#x27;English&#x27;}] ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">Released</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\"></td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">Toy Story</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">False</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">7.7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;iso_639_1&#x27;: &#x27;en&#x27;,<br>&#x27;name&#x27;: &#x27;English&#x27;}, ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">Released</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">Roll the dice and unleash<br>the excitement! ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">Jumanji</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">False</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">6.9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;iso_639_1&#x27;: &#x27;en&#x27;,<br>&#x27;name&#x27;: &#x27;English&#x27;}] ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">Released</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">Still Yelling. Still<br>Fighting. Still Ready ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">Grumpier Old Men</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">False</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">6.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;iso_639_1&#x27;: &#x27;en&#x27;,<br>&#x27;name&#x27;: &#x27;English&#x27;}] ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">Released</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">Friends are the people<br>who let you be ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">Waiting to Exhale</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">False</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">6.1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;iso_639_1&#x27;: &#x27;en&#x27;,<br>&#x27;name&#x27;: &#x27;English&#x27;}] ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">Released</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">Just When His World Is<br>Back To Normal... He&#x27; ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">Father of the Bride Part<br>II ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">False</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">5.7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;iso_639_1&#x27;: &#x27;en&#x27;,<br>&#x27;name&#x27;: &#x27;English&#x27;}, ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">Released</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">A Los Angeles Crime Saga</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">Heat</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">False</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">7.7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;iso_639_1&#x27;: &#x27;fr&#x27;,<br>&#x27;name&#x27;: &#x27;Français&#x27;}, ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">Released</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">You are cordially invited<br>to the most surprising ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">Sabrina</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">False</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">6.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;iso_639_1&#x27;: &#x27;en&#x27;,<br>&#x27;name&#x27;: &#x27;English&#x27;}, ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">Released</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">The Original Bad Boys.</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">Tom and Huck</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">False</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">5.4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;iso_639_1&#x27;: &#x27;en&#x27;,<br>&#x27;name&#x27;: &#x27;English&#x27;}] ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">Released</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">Terror goes into<br>overtime. ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">Sudden Death</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">False</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">5.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;iso_639_1&#x27;: &#x27;en&#x27;,<br>&#x27;name&#x27;: &#x27;English&#x27;}, ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">Released</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">No limits. No fears. No<br>substitutes. ...</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">GoldenEye</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">False</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">6.6</td>\n",
       "    </tr>\n",
       "</table>\n",
       "<table frame=\"box\" rules=\"cols\">\n",
       "    <tr>\n",
       "        <th style=\"padding-left: 1em; padding-right: 1em; text-align: center\">vote_count</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">5415</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">2413</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">92</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">34</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">173</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">1886</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">141</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">45</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">174</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">1194</td>\n",
       "    </tr>\n",
       "</table>\n",
       "[45459 rows x 24 columns]<br/>Note: Only the head of the SFrame is printed.<br/>You can use print_rows(num_rows=m, num_columns=n) to print more rows and columns.\n",
       "</div>"
      ],
      "text/plain": [
       "Columns:\n",
       "\tadult\tstr\n",
       "\tbelongs_to_collection\tdict\n",
       "\tbudget\tint\n",
       "\tgenres\tlist\n",
       "\thomepage\tstr\n",
       "\tid\tint\n",
       "\timdb_id\tstr\n",
       "\toriginal_language\tstr\n",
       "\toriginal_title\tstr\n",
       "\toverview\tstr\n",
       "\tpopularity\tfloat\n",
       "\tposter_path\tstr\n",
       "\tproduction_companies\tlist\n",
       "\tproduction_countries\tlist\n",
       "\trelease_date\tstr\n",
       "\trevenue\tint\n",
       "\truntime\tfloat\n",
       "\tspoken_languages\tlist\n",
       "\tstatus\tstr\n",
       "\ttagline\tstr\n",
       "\ttitle\tstr\n",
       "\tvideo\tstr\n",
       "\tvote_average\tfloat\n",
       "\tvote_count\tint\n",
       "\n",
       "Rows: 45459\n",
       "\n",
       "Data:\n",
       "+-------+-------------------------------+----------+\n",
       "| adult |     belongs_to_collection     |  budget  |\n",
       "+-------+-------------------------------+----------+\n",
       "| False | {'id': 10194, 'name': 'Toy... | 30000000 |\n",
       "| False |              None             | 65000000 |\n",
       "| False | {'id': 119050, 'name': 'Gr... |    0     |\n",
       "| False |              None             | 16000000 |\n",
       "| False | {'id': 96871, 'name': 'Fat... |    0     |\n",
       "| False |              None             | 60000000 |\n",
       "| False |              None             | 58000000 |\n",
       "| False |              None             |    0     |\n",
       "| False |              None             | 35000000 |\n",
       "| False | {'id': 645, 'name': 'James... | 58000000 |\n",
       "+-------+-------------------------------+----------+\n",
       "+--------------------------------+-------------------------------+-------+\n",
       "|             genres             |            homepage           |   id  |\n",
       "+--------------------------------+-------------------------------+-------+\n",
       "| [{'id': 16, 'name': 'Anima...  | http://toystory.disney.com... |  862  |\n",
       "| [{'id': 12, 'name': 'Adven...  |                               |  8844 |\n",
       "| [{'id': 10749, 'name': 'Ro...  |                               | 15602 |\n",
       "| [{'id': 35, 'name': 'Comed...  |                               | 31357 |\n",
       "| [{'id': 35, 'name': 'Comedy'}] |                               | 11862 |\n",
       "| [{'id': 28, 'name': 'Actio...  |                               |  949  |\n",
       "| [{'id': 35, 'name': 'Comed...  |                               | 11860 |\n",
       "| [{'id': 28, 'name': 'Actio...  |                               | 45325 |\n",
       "| [{'id': 28, 'name': 'Actio...  |                               |  9091 |\n",
       "| [{'id': 12, 'name': 'Adven...  | http://www.mgm.com/view/mo... |  710  |\n",
       "+--------------------------------+-------------------------------+-------+\n",
       "+-----------+-------------------+-----------------------------+\n",
       "|  imdb_id  | original_language |        original_title       |\n",
       "+-----------+-------------------+-----------------------------+\n",
       "| tt0114709 |         en        |          Toy Story          |\n",
       "| tt0113497 |         en        |           Jumanji           |\n",
       "| tt0113228 |         en        |       Grumpier Old Men      |\n",
       "| tt0114885 |         en        |      Waiting to Exhale      |\n",
       "| tt0113041 |         en        | Father of the Bride Part II |\n",
       "| tt0113277 |         en        |             Heat            |\n",
       "| tt0114319 |         en        |           Sabrina           |\n",
       "| tt0112302 |         en        |         Tom and Huck        |\n",
       "| tt0114576 |         en        |         Sudden Death        |\n",
       "| tt0113189 |         en        |          GoldenEye          |\n",
       "+-----------+-------------------+-----------------------------+\n",
       "+-------------------------------+------------+-------------------------------+\n",
       "|            overview           | popularity |          poster_path          |\n",
       "+-------------------------------+------------+-------------------------------+\n",
       "| Led by Woody, Andy's toys ... | 21.946943  | /rhIRbceoE9lR4veEXuwCC2wAR... |\n",
       "| When siblings Judy and Pet... | 17.015539  | /vzmL6fP7aPKNKPRTFnZmiUfci... |\n",
       "| A family wedding reignites... |  11.7129   | /6ksm1sjKMFLbO7UY2i6G1ju9S... |\n",
       "| Cheated on, mistreated and... |  3.859495  | /16XOMpEaLWkrcPqSQqhTmeJuq... |\n",
       "| Just when George Banks has... |  8.387519  | /e64sOI48hQXyru7naBFyssKFx... |\n",
       "| Obsessive master thief, Ne... | 17.924927  | /zMyfPUelumio3tiDKPffaUpsQ... |\n",
       "| An ugly duckling having un... |  6.677277  | /jQh15y5YB7bWz1NtffNZmRw0s... |\n",
       "| A mischievous young boy, T... |  2.561161  | /sGO5Qa55p7wTu7FJcX4H4xIVK... |\n",
       "| International action super... |  5.23158   | /eoWvKD60lT95Ss1MYNgVExpo5... |\n",
       "| James Bond must unmask the... | 14.686036  | /5c0ovjT41KnYIHYuF4AWsTe3s... |\n",
       "+-------------------------------+------------+-------------------------------+\n",
       "+-------------------------------+-------------------------------+--------------+\n",
       "|      production_companies     |      production_countries     | release_date |\n",
       "+-------------------------------+-------------------------------+--------------+\n",
       "| [{'name': 'Pixar Animation... | [{'iso_3166_1': 'US', 'nam... |  1995-10-30  |\n",
       "| [{'name': 'TriStar Picture... | [{'iso_3166_1': 'US', 'nam... |  1995-12-15  |\n",
       "| [{'name': 'Warner Bros.', ... | [{'iso_3166_1': 'US', 'nam... |  1995-12-22  |\n",
       "| [{'name': 'Twentieth Centu... | [{'iso_3166_1': 'US', 'nam... |  1995-12-22  |\n",
       "| [{'name': 'Sandollar Produ... | [{'iso_3166_1': 'US', 'nam... |  1995-02-10  |\n",
       "| [{'name': 'Regency Enterpr... | [{'iso_3166_1': 'US', 'nam... |  1995-12-15  |\n",
       "| [{'name': 'Paramount Pictu... | [{'iso_3166_1': 'DE', 'nam... |  1995-12-15  |\n",
       "| [{'name': 'Walt Disney Pic... | [{'iso_3166_1': 'US', 'nam... |  1995-12-22  |\n",
       "| [{'name': 'Universal Pictu... | [{'iso_3166_1': 'US', 'nam... |  1995-12-22  |\n",
       "| [{'name': 'United Artists'... | [{'iso_3166_1': 'GB', 'nam... |  1995-11-16  |\n",
       "+-------------------------------+-------------------------------+--------------+\n",
       "+-----------+---------+-------------------------------+----------+\n",
       "|  revenue  | runtime |        spoken_languages       |  status  |\n",
       "+-----------+---------+-------------------------------+----------+\n",
       "| 373554033 |   81.0  | [{'iso_639_1': 'en', 'name... | Released |\n",
       "| 262797249 |  104.0  | [{'iso_639_1': 'en', 'name... | Released |\n",
       "|     0     |  101.0  | [{'iso_639_1': 'en', 'name... | Released |\n",
       "|  81452156 |  127.0  | [{'iso_639_1': 'en', 'name... | Released |\n",
       "|  76578911 |  106.0  | [{'iso_639_1': 'en', 'name... | Released |\n",
       "| 187436818 |  170.0  | [{'iso_639_1': 'en', 'name... | Released |\n",
       "|     0     |  127.0  | [{'iso_639_1': 'fr', 'name... | Released |\n",
       "|     0     |   97.0  | [{'iso_639_1': 'en', 'name... | Released |\n",
       "|  64350171 |  106.0  | [{'iso_639_1': 'en', 'name... | Released |\n",
       "| 352194034 |  130.0  | [{'iso_639_1': 'en', 'name... | Released |\n",
       "+-----------+---------+-------------------------------+----------+\n",
       "+-------------------------------+-----+\n",
       "|            tagline            | ... |\n",
       "+-------------------------------+-----+\n",
       "|                               | ... |\n",
       "| Roll the dice and unleash ... | ... |\n",
       "| Still Yelling. Still Fight... | ... |\n",
       "| Friends are the people who... | ... |\n",
       "| Just When His World Is Bac... | ... |\n",
       "|    A Los Angeles Crime Saga   | ... |\n",
       "| You are cordially invited ... | ... |\n",
       "|     The Original Bad Boys.    | ... |\n",
       "|   Terror goes into overtime.  | ... |\n",
       "| No limits. No fears. No su... | ... |\n",
       "+-------------------------------+-----+\n",
       "[45459 rows x 24 columns]\n",
       "Note: Only the head of the SFrame is printed.\n",
       "You can use print_rows(num_rows=m, num_columns=n) to print more rows and columns."
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd_items"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2020-08-03T18:25:53.683946Z",
     "start_time": "2020-08-03T18:25:53.670160Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div style=\"max-height:1000px;max-width:1500px;overflow:auto;\"><table frame=\"box\" rules=\"cols\">\n",
       "    <tr>\n",
       "        <th style=\"padding-left: 1em; padding-right: 1em; text-align: center\">id</th>\n",
       "        <th style=\"padding-left: 1em; padding-right: 1em; text-align: center\">production_companies</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">862</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;name&#x27;: &#x27;Pixar<br>Animation Studios&#x27;, &#x27; ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">8844</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;name&#x27;: &#x27;TriStar<br>Pictures&#x27;, &#x27;id&#x27;: 559}, ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">15602</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;name&#x27;: &#x27;Warner Bros.&#x27;,<br>&#x27;id&#x27;: 6194}, {&#x27;name&#x27;: ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">31357</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;name&#x27;: &#x27;Twentieth<br>Century Fox Film ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">11862</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;name&#x27;: &#x27;Sandollar<br>Productions&#x27;, &#x27;id&#x27;: ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">949</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;name&#x27;: &#x27;Regency<br>Enterprises&#x27;, &#x27;id&#x27;: 5 ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">11860</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;name&#x27;: &#x27;Paramount<br>Pictures&#x27;, &#x27;id&#x27;: 4}, ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">45325</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;name&#x27;: &#x27;Walt Disney<br>Pictures&#x27;, &#x27;id&#x27;: 2}] ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">9091</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;name&#x27;: &#x27;Universal<br>Pictures&#x27;, &#x27;id&#x27;: 33}, ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">710</td>\n",
       "        <td style=\"padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top\">[{&#x27;name&#x27;: &#x27;United<br>Artists&#x27;, &#x27;id&#x27;: 60}, ...</td>\n",
       "    </tr>\n",
       "</table>\n",
       "[45459 rows x 2 columns]<br/>Note: Only the head of the SFrame is printed.<br/>You can use print_rows(num_rows=m, num_columns=n) to print more rows and columns.\n",
       "</div>"
      ],
      "text/plain": [
       "Columns:\n",
       "\tid\tint\n",
       "\tproduction_companies\tlist\n",
       "\n",
       "Rows: 45459\n",
       "\n",
       "Data:\n",
       "+-------+-------------------------------+\n",
       "|   id  |      production_companies     |\n",
       "+-------+-------------------------------+\n",
       "|  862  | [{'name': 'Pixar Animation... |\n",
       "|  8844 | [{'name': 'TriStar Picture... |\n",
       "| 15602 | [{'name': 'Warner Bros.', ... |\n",
       "| 31357 | [{'name': 'Twentieth Centu... |\n",
       "| 11862 | [{'name': 'Sandollar Produ... |\n",
       "|  949  | [{'name': 'Regency Enterpr... |\n",
       "| 11860 | [{'name': 'Paramount Pictu... |\n",
       "| 45325 | [{'name': 'Walt Disney Pic... |\n",
       "|  9091 | [{'name': 'Universal Pictu... |\n",
       "|  710  | [{'name': 'United Artists'... |\n",
       "+-------+-------------------------------+\n",
       "[45459 rows x 2 columns]\n",
       "Note: Only the head of the SFrame is printed.\n",
       "You can use print_rows(num_rows=m, num_columns=n) to print more rows and columns."
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd_items.select_columns(['id', 'production_companies'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2020-08-03T18:21:23.983552Z",
     "start_time": "2020-08-03T18:21:23.535669Z"
    }
   },
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "pd_items = pd.read_csv('movielens/movies_metadata.csv',low_memory=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2020-08-03T18:21:58.931104Z",
     "start_time": "2020-08-03T18:21:58.908145Z"
    }
   },
   "outputs": [],
   "source": [
    "pd_items.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2020-08-03T08:50:57.058901Z",
     "start_time": "2020-08-03T08:50:57.055292Z"
    }
   },
   "outputs": [],
   "source": [
    "import ast\n",
    "def json_format(pandas_dict):\n",
    "    \n",
    "    dictionary = ast.literal_eval(pandas_dict)\n",
    "    json_dict  = json.dumps(dictionary)\n",
    "    \n",
    "    return json_dict"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2020-08-03T08:50:57.503497Z",
     "start_time": "2020-08-03T08:50:57.499639Z"
    }
   },
   "outputs": [],
   "source": [
    "json_format(pd_items.iloc[0,1])\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2020-08-03T08:51:11.688788Z",
     "start_time": "2020-08-03T08:51:07.156685Z"
    }
   },
   "outputs": [],
   "source": [
    "for i in range(pd_items.shape[0]):\n",
    "    if( pd.notna(pd_items.iloc[i,1]) ):   \n",
    "        pd_items.iloc[i,1] = json_format(pd_items.iloc[i,1])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2020-08-03T08:54:33.695608Z",
     "start_time": "2020-08-03T08:53:44.054292Z"
    }
   },
   "outputs": [],
   "source": [
    "for i in range(pd_items.shape[0]):\n",
    "    if( pd.notna(pd_items.iloc[i,3]) ):   \n",
    "        pd_items.iloc[i,3] = json_format(pd_items.iloc[i,3])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2020-08-03T08:58:14.063753Z",
     "start_time": "2020-08-03T08:57:25.659182Z"
    }
   },
   "outputs": [],
   "source": [
    "for i in range(pd_items.shape[0]):\n",
    "    if( pd.notna(pd_items.iloc[i,17]) ):   \n",
    "        pd_items.iloc[i,17] = json_format(pd_items.iloc[i,17])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2020-08-03T09:05:04.338157Z",
     "start_time": "2020-08-03T09:05:03.252775Z"
    }
   },
   "outputs": [],
   "source": [
    "pd_items.to_csv('sample_items.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2020-08-03T09:06:14.770701Z",
     "start_time": "2020-08-03T09:06:12.629369Z"
    }
   },
   "outputs": [],
   "source": [
    "data = tc.SFrame('movielens/movies_metadata.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2020-08-03T09:06:34.119830Z",
     "start_time": "2020-08-03T09:06:34.004440Z"
    }
   },
   "outputs": [],
   "source": [
    "data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2020-08-03T09:56:07.230559Z",
     "start_time": "2020-08-03T09:56:07.145457Z"
    }
   },
   "outputs": [],
   "source": [
    "m_side_info = tc.factorization_recommender.create(actions,target='rating',user_id='userId',item_id='movieId',\n",
    "                                                       item_data=data.select_columns(['movieId', 'production_companies']))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2020-08-03T10:02:55.829808Z",
     "start_time": "2020-08-03T10:02:55.816038Z"
    }
   },
   "outputs": [],
   "source": [
    "#data = data.rename({'id': 'movieId'})\n",
    "data.select_columns(['movieId', 'production_companies'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "ExecuteTime": {
     "end_time": "2020-08-03T09:54:35.799873Z",
     "start_time": "2020-08-03T09:54:35.777463Z"
    }
   },
   "outputs": [],
   "source": [
    "actions"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3.7.4 64-bit ('base': conda)",
   "language": "python",
   "name": "python37464bitbasecondaea83915b4e5942dba7e70c8d283c9269"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.6"
  },
  "latex_envs": {
   "LaTeX_envs_menu_present": true,
   "autoclose": false,
   "autocomplete": true,
   "bibliofile": "biblio.bib",
   "cite_by": "apalike",
   "current_citInitial": 1,
   "eqLabelWithNumbers": true,
   "eqNumInitial": 1,
   "hotkeys": {
    "equation": "Ctrl-E",
    "itemize": "Ctrl-I"
   },
   "labels_anchors": false,
   "latex_user_defs": false,
   "report_style_numbering": false,
   "user_envs_cfg": false
  },
  "toc": {
   "base_numbering": 1,
   "nav_menu": {},
   "number_sections": true,
   "sideBar": true,
   "skip_h1_title": false,
   "title_cell": "Table of Contents",
   "title_sidebar": "Contents",
   "toc_cell": false,
   "toc_position": {},
   "toc_section_display": true,
   "toc_window_display": false
  },
  "varInspector": {
   "cols": {
    "lenName": 16,
    "lenType": 16,
    "lenVar": 40
   },
   "kernels_config": {
    "python": {
     "delete_cmd_postfix": "",
     "delete_cmd_prefix": "del ",
     "library": "var_list.py",
     "varRefreshCmd": "print(var_dic_list())"
    },
    "r": {
     "delete_cmd_postfix": ") ",
     "delete_cmd_prefix": "rm(",
     "library": "var_list.r",
     "varRefreshCmd": "cat(var_dic_list()) "
    }
   },
   "types_to_exclude": [
    "module",
    "function",
    "builtin_function_or_method",
    "instance",
    "_Feature"
   ],
   "window_display": false
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
